apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: quay-credentials
  namespace: stackrox
  resourceVersion: '315912'
  uid: 2bc6f1af-30a1-4c85-b7a8-6a5102e7fc23
spec:
  params:
    - description: Namespace where credentials secret will be created.
      name: namespace
      type: string
    - description: Quay username.
      name: username
      type: string
    - description: Quay password.
      name: password
      type: string
  tasks:
    - name: create-quay-creds-secreet
      params:
        - name: SCRIPT
          value: |
            echo "Create quay creds secret."
            oc create secret generic quay-creds \
              --from-literal=username=$(params.username) \
              --from-literal=password=$(params.password) \
              -n $(params.namespace)

            echo "Annotate secret for tekton."

            oc annotate secret quay-creds \
              tekton.dev/docker-0=https://quay.io \
              -n $(params.namespace)
        - name: VERSION
          value: latest
      taskRef:
        kind: ClusterTask
        name: openshift-client
